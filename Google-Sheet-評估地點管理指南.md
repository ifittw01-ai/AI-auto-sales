# 📍 Google Sheet 評估地點管理完整指南

## 🎯 系統優勢

使用 Google Sheet 動態管理評估地點後，你可以：
- ✅ **即時更新**：修改地址後立即生效，不需要改代碼
- ✅ **自動計數**：每次報名自動更新人數
- ✅ **名額控制**：自動顯示剩餘名額，額滿自動隱藏
- ✅ **日期管理**：過期的選項自動隱藏
- ✅ **靈活排序**：自由調整選項顯示順序
- ✅ **多語言支持**：可以設定不同語言版本

---

## 📊 步驟 1：創建「評估地點」工作表

### 1.1 打開你的 Google Sheet

打開網址：
```
https://docs.google.com/spreadsheets/d/1tvKaa07m-lxqyF4ZWgpOsC2ESiXBvNeN5IbA013lEf0/edit
```

### 1.2 新增工作表

1. 點擊左下角的「+」號
2. 將新工作表命名為：**評估地點**（必須是這個名稱）

### 1.3 設置標題列（第一行）

在第一行輸入以下標題（**大小寫要完全一致**）：

| A列 | B列 | C列 | D列 | E列 | F列 | G列 | H列 | I列 |
|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 選項ID | 排序 | 完整描述 | 開始日期 | 結束日期 | 最大容量 | 目前報名數 | 是否啟用 | 語言 |

---

## 📝 步驟 2：填寫資料（範例）

### 範例 1：基本設定（無容量限制）

| 選項ID | 排序 | 完整描述 | 開始日期 | 結束日期 | 最大容量 | 目前報名數 | 是否啟用 | 語言 |
|--------|------|----------|----------|----------|----------|-----------|----------|------|
| 1 | 1 | 11/3 星期一 晚上 7:00~9:00 捷運新店區公所站一號出口1分鐘到 北新路一段259號2樓 | 2024/11/01 | 2024/11/03 | 0 | 0 | 是 | zh-TW |
| 2 | 2 | 11/5 星期三 下午 2:00~4:00 捷運新店區公所站一號出口1分鐘到 北新路一段259號2樓 | 2024/11/01 | 2024/11/05 | 0 | 0 | 是 | zh-TW |

### 範例 2：進階設定（含容量限制）

| 選項ID | 排序 | 完整描述 | 開始日期 | 結束日期 | 最大容量 | 目前報名數 | 是否啟用 | 語言 |
|--------|------|----------|----------|----------|----------|-----------|----------|------|
| 1 | 1 | 11/8 星期五 下午 2:00~4:00 台北信義區 A25大樓 3樓會議室 | 2024/11/01 | 2024/11/08 | 30 | 5 | 是 | zh-TW |
| 2 | 2 | 11/10 星期日 早上 10:00~12:00 台中文心路商務中心 B1會議廳 | 2024/11/01 | 2024/11/10 | 50 | 45 | 是 | zh-TW |
| 3 | 3 | 11/12 星期二 晚上 7:00~9:00 高雄夢時代購物中心 6樓演講廳 | 2024/11/05 | 2024/11/12 | 20 | 2 | 是 | zh-TW |

**效果**：
- 選項1 會顯示：`11/8 星期五... [剩餘 25 個名額]`
- 選項2 會顯示：`11/10 星期日... [僅剩 5 個名額]`（因為少於5個會標示「僅剩」）
- 選項3 會顯示：`11/12 星期二... [剩餘 18 個名額]`

---

## 📖 欄位說明

### A列：選項ID（必填）
- **格式**：數字或英文，例如：`1`, `2`, `A`, `B`
- **用途**：唯一識別碼，用於更新報名人數
- **範例**：`1`, `2`, `taipei-1`, `online-session`

### B列：排序（必填）
- **格式**：數字
- **用途**：控制選項顯示順序（數字越小越前面）
- **範例**：`1`, `2`, `3`（建議用10, 20, 30方便中間插入）

### C列：完整描述（必填）
- **格式**：文字
- **用途**：在報名表單中顯示的完整文字
- **範例**：`11/3 星期一 晚上 7:00~9:00 捷運新店區公所站一號出口1分鐘到 北新路一段259號2樓`

### D列：開始日期（選填）
- **格式**：日期（例如：`2024/11/01`）
- **用途**：在這個日期之前，選項不會顯示
- **範例**：`2024/11/01`
- **留空**：表示立即開放

### E列：結束日期（選填）
- **格式**：日期（例如：`2024/11/30`）
- **用途**：過了這個日期，選項自動隱藏
- **範例**：`2024/11/30`
- **留空**：表示永久有效

### F列：最大容量（選填）
- **格式**：數字
- **用途**：設定最多可報名人數
- **範例**：`30`（最多30人）
- **設為 `0`**：表示無限制
- **達到上限**：選項自動隱藏

### G列：目前報名數（系統自動更新）
- **格式**：數字
- **用途**：記錄目前已報名人數
- **初始值**：`0`
- **⚠️ 重要**：這個欄位會被系統自動更新，不要手動修改！

### H列：是否啟用（必填）
- **格式**：文字
- **允許值**：只能填 `是` 或 `否`
- **用途**：手動控制選項是否顯示
- **範例**：`是`（顯示）、`否`（隱藏）

### I列：語言（選填）
- **格式**：語言代碼
- **用途**：多語言網站時使用
- **範例**：`zh-TW`（繁體中文）、`zh-CN`（簡體中文）、`en`（英文）
- **留空**：預設為 `zh-TW`

---

## 🎯 常見使用場景

### 場景 1：新增新的評估時段

只需在 Google Sheet 中新增一行：

| 選項ID | 排序 | 完整描述 | 開始日期 | 結束日期 | 最大容量 | 目前報名數 | 是否啟用 | 語言 |
|--------|------|----------|----------|----------|----------|-----------|----------|------|
| 4 | 4 | 11/15 星期三 下午 3:00~5:00 新竹科學園區 創新大樓 8樓 | 2024/11/08 | 2024/11/15 | 25 | 0 | 是 | zh-TW |

**保存後**，網頁會自動顯示新選項！

---

### 場景 2：修改地址

直接在 **C列（完整描述）** 修改文字即可，例如：

**修改前**：
```
11/3 星期一 晚上 7:00~9:00 捷運新店區公所站一號出口1分鐘到 北新路一段259號2樓
```

**修改後**：
```
11/3 星期一 晚上 7:00~9:00 捷運新店區公所站二號出口 北新路一段300號3樓會議室
```

**保存後**，網頁立即顯示新地址！

---

### 場景 3：暫時關閉某個選項

將 **H列（是否啟用）** 改為 `否` 即可。

例如場地臨時無法使用，改成：

| 是否啟用 |
|----------|
| 否 |

**保存後**，該選項立即從網頁消失！

---

### 場景 4：調整顯示順序

修改 **B列（排序）** 的數字。

**例如**：想讓選項3排在最前面：

| 選項ID | 排序 |
|--------|------|
| 3 | 1 |
| 1 | 2 |
| 2 | 3 |

**保存後**，選項3會顯示在最上方！

---

### 場景 5：設定容量限制

設定 **F列（最大容量）** 為具體數字。

| 選項ID | 最大容量 | 目前報名數 |
|--------|----------|-----------|
| 1 | 30 | 28 |

**效果**：
- 顯示：`11/8 星期五... [僅剩 2 個名額]`
- 當報名數達到 30 時，選項自動消失

---

## 🚀 步驟 3：部署 Google Apps Script

### 3.1 打開 Google Apps Script

1. 在 Google Sheet 中，點擊「擴充功能」→「Apps Script」
2. 或直接前往：https://script.google.com

### 3.2 複製代碼

將 `google-apps-script-enhanced.js` 的全部內容複製到 `Code.gs`

### 3.3 修改 SPREADSHEET_ID

找到第 22 行，確認 SPREADSHEET_ID 是你的 Google Sheet ID：

```javascript
const SPREADSHEET_ID = '1tvKaa07m-lxqyF4ZWgpOsC2ESiXBvNeN5IbA013lEf0';
```

### 3.4 部署為網頁應用程式

1. 點擊右上角「部署」→「新增部署」
2. 選擇類型：「網頁應用程式」
3. 執行身分：「我」
4. **存取權限：「所有人」**（⚠️ 重要！）
5. 點擊「部署」
6. 複製網頁應用程式 URL

### 3.5 更新 script.js

將部署 URL 更新到 `script.js` 第 426 行：

```javascript
const GOOGLE_SCRIPT_URL = '你的部署URL';
```

---

## ✅ 測試步驟

### 測試 1：測試 API

在瀏覽器打開：
```
你的部署URL?action=getRegions
```

應該會看到 JSON 格式的地點列表：
```json
{
  "success": true,
  "regions": [
    {
      "id": "1",
      "text": "11/3 星期一...",
      "fullDesc": "11/3 星期一...",
      "sortOrder": 1,
      "availableSeats": 0,
      "language": "zh-TW"
    }
  ],
  "count": 1
}
```

### 測試 2：測試網頁載入

1. 打開 `index.html`
2. 按 F12 打開開發者工具
3. 查看 Console，應該會看到：
```
📍 正在載入評估地點選項...
✅ 成功載入 2 個評估地點
```

### 測試 3：測試報名計數

1. 提交一個測試表單
2. 回到 Google Sheet
3. 查看 **G列（目前報名數）** 應該自動 +1

---

## 🎨 進階功能

### 功能 1：多語言支持

設定不同語言的選項：

| 選項ID | 完整描述 | 語言 |
|--------|----------|------|
| 1 | 11/3 Monday 7:00PM-9:00PM ... | en |
| 2 | 11/3 星期一 晚上 7:00~9:00 ... | zh-TW |
| 3 | 11/3 星期一 晚上 7:00~9:00 ... | zh-CN |

前端可以根據用戶語言顯示對應選項。

### 功能 2：緊急名額提醒

當剩餘名額 ≤ 5 時，系統自動標示「僅剩」：
```
11/8 星期五... [僅剩 3 個名額]
```

### 功能 3：日期自動管理

設定結束日期後，過期選項自動隱藏，無需手動管理。

---

## ❓ 常見問題

### Q1：修改後網頁沒有更新？

**原因**：Google Apps Script 有 10 分鐘緩存

**解決方法**：
1. 等待 10 分鐘
2. 或在 Apps Script 中執行 `clearCache()` 函數清除緩存

### Q2：報名人數沒有自動增加？

**檢查**：
1. 確認 Apps Script 已正確部署（選擇「新版本」）
2. 確認存取權限設為「所有人」
3. 查看 Apps Script 執行記錄是否有錯誤

### Q3：選項沒有顯示？

**檢查**：
1. **H列（是否啟用）** 是否為「是」
2. **開始日期** 是否已到
3. **結束日期** 是否已過
4. **容量** 是否已滿

### Q4：如何重置報名人數？

直接在 Google Sheet 中將 **G列（目前報名數）** 改為 `0`

---

## 📌 重要提醒

### ⚠️ 必須注意的事項：

1. **工作表名稱**必須是「評估地點」（不能有空格或其他字符）
2. **標題列**（第一行）不能修改
3. **G列（目前報名數）** 由系統自動更新，不要手動改動
4. **H列（是否啟用）** 只能填「是」或「否」
5. 部署時**存取權限**必須設為「所有人」

### ✅ 最佳實踐：

1. **排序**建議用 10, 20, 30，方便中間插入
2. **選項ID** 建議用有意義的代碼，如 `taipei-1`, `online-1`
3. **定期檢查**報名人數是否正常累加
4. **備份** Google Sheet（檔案 → 建立副本）

---

## 🎉 完成！

現在你可以：
- ✅ 在 Google Sheet 中輕鬆管理所有評估地點
- ✅ 修改後立即生效，無需改代碼
- ✅ 自動追蹤報名人數和剩餘名額
- ✅ 靈活控制顯示和隱藏選項

**享受自動化管理的便利吧！** 🚀

