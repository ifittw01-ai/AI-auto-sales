# 🚀 動態評估地點管理 - 快速開始

## 📋 3步驟完成設定

### 第1步：創建 Google Sheet 工作表（2分鐘）

1. 打開你的 Google Sheet：
   ```
   https://docs.google.com/spreadsheets/d/1tvKaa07m-lxqyF4ZWgpOsC2ESiXBvNeN5IbA013lEf0/edit
   ```

2. 新增工作表，命名為：**評估地點**

3. 複製貼上以下內容到第一行（標題列）：
   ```
   選項ID	排序	完整描述	開始日期	結束日期	最大容量	目前報名數	是否啟用	語言
   ```

4. 填入範例資料（第二行開始）：
   ```
   1	1	11/3 星期一 晚上 7:00~9:00 捷運新店區公所站一號出口1分鐘到 北新路一段259號2樓	2024/11/01	2024/11/03	30	0	是	zh-TW
   2	2	11/5 星期三 下午 2:00~4:00 捷運新店區公所站一號出口1分鐘到 北新路一段259號2樓	2024/11/01	2024/11/05	50	0	是	zh-TW
   ```

---

### 第2步：更新 Google Apps Script（3分鐘）

1. 打開 https://script.google.com

2. 找到你的專案

3. **完整複製** `google-apps-script-enhanced.js` 的所有內容

4. **貼上覆蓋** Code.gs

5. **保存**（Ctrl + S）

6. **重新部署**：
   - 點擊「部署」→「管理部署」
   - 點擊「✏️ 編輯」
   - **版本**：選擇「**新版本**」（重要！）
   - **存取權限**：確認是「所有人」
   - 點擊「部署」

7. 等待 1-2 分鐘讓部署生效

---

### 第3步：更新並部署網頁（2分鐘）

1. **已經完成**！`script.js` 和 `index.html` 已經更新

2. Push 到 GitHub：
   ```bash
   git add .
   git commit -m "Add dynamic region management from Google Sheet"
   git push
   ```

3. 等待 GitHub Pages 部署（通常 1-2 分鐘）

---

## ✅ 測試

### 測試 1：API 是否正常

打開瀏覽器訪問：
```
你的Google_Script_URL?action=getRegions
```

應該會看到 JSON 格式的地點列表。

### 測試 2：網頁是否載入

1. 打開 `index.html`
2. 按 F12 → Console
3. 應該看到：`✅ 成功載入 X 個評估地點`

### 測試 3：報名是否計數

1. 提交測試表單
2. 回 Google Sheet 查看「目前報名數」是否 +1

---

## 🎯 日常使用

### 修改地址

直接在 Google Sheet 的「完整描述」欄修改 → 保存 → 完成！

### 新增時段

在 Google Sheet 新增一行 → 填入資料 → 保存 → 完成！

### 關閉選項

將「是否啟用」改為「否」→ 保存 → 完成！

---

## 🎨 進階功能

### 功能 1：設定容量限制

在「最大容量」填入數字（如 30），系統會自動：
- 顯示剩餘名額
- 額滿自動隱藏

### 功能 2：設定有效期

在「開始日期」和「結束日期」填入日期，系統會自動：
- 未到期：不顯示
- 已過期：自動隱藏

### 功能 3：調整順序

修改「排序」數字，數字越小越前面。

---

## ❓ 故障排查

| 問題 | 解決方法 |
|------|---------|
| 網頁沒顯示新選項 | 1. 檢查「是否啟用」是否為「是」<br>2. 等待 10 分鐘（緩存時間）<br>3. 執行 `clearCache()` |
| 報名數沒增加 | 1. 確認 Apps Script 選擇「新版本」部署<br>2. 檢查存取權限是否為「所有人」 |
| 載入顯示錯誤 | 1. 檢查工作表名稱是否為「評估地點」<br>2. 檢查 SPREADSHEET_ID 是否正確 |

---

## 📚 詳細文檔

查看完整功能說明：
- `Google-Sheet-評估地點管理指南.md` - 完整使用指南
- `google-apps-script-enhanced.js` - 程式碼說明

---

## 🎉 完成！

現在你可以輕鬆管理評估地點，無需再修改 HTML 代碼！

**下次要改地址？** 直接在 Google Sheet 中改就行了！🚀

