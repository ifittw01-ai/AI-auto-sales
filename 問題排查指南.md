# 🔧 問題排查指南

## 問題：表單中沒有資料

讓我們一步步排查問題。

---

## 步驟 1：檢查瀏覽器 Console

### 1.1 開啟開發者工具
1. 開啟 `index.html`
2. 按 **F12** 鍵
3. 點擊 **"Console"** 標籤

### 1.2 測試提交
1. 點擊「我要優惠」
2. 填寫表單
3. 提交
4. **觀察 Console 訊息**

### 1.3 可能的訊息

#### ✅ 成功訊息：
```
✅ 資料已成功提交到 Google 表單
```
→ 如果看到這個，表示程式有執行，可能是 ID 設定錯誤

#### ❌ 錯誤訊息：
```
❌ Google 表單提交失敗: [錯誤訊息]
```
→ 請記下完整錯誤訊息

#### ⚠️ CORS 錯誤：
```
Access to fetch ... has been blocked by CORS policy
```
→ 這是正常的！Google Forms 用 no-cors 模式，會看起來像錯誤但其實有送出

---

## 步驟 2：驗證 Form ID 格式

### 2.1 取得正確的 Form ID

1. 開啟您的 Google 表單（編輯模式）
2. 查看網址列，應該像這樣：
   ```
   https://docs.google.com/forms/d/【這是Form ID】/edit
   ```

3. **重要：** 複製 `/d/` 和 `/edit` 之間的那段

#### 錯誤示例 ❌
```
formId: '1FAIpQLSfgpRp3GyT27oanx3_pLwAlGVgCGdvH-gPnyS_fW-LsueGpFw'
```
這看起來是 **回應 ID**，不是 Form ID！

#### 正確示例 ✅
```
formId: '1a2b3c4d5e6f7g8h9i0j'
```
Form ID 通常較短，由英文和數字組成

### 2.2 如何確認

**方法 1：從編輯模式網址**
```
https://docs.google.com/forms/d/【複製這段】/edit
                              ↑
                         這才是 Form ID
```

**方法 2：從傳送功能**
1. 點擊「傳送」按鈕
2. 點擊「連結」圖示
3. 看到的網址：
   ```
   https://docs.google.com/forms/d/e/【不要複製這段】/viewform
   ```
   **注意：** 如果看到 `/d/e/` 那後面那段是錯的！

**正確的應該是：**
```
https://docs.google.com/forms/d/【複製這段】/viewform
```

---

## 步驟 3：重新取得 entry ID

### 3.1 清空所有欄位內容再重做

1. 在 Google 表單點擊右上角 **「⋮」**
2. 選擇 **「取得預填連結」**
3. **重要：填寫所有欄位**
   - 姓名：測試
   - 電子郵件：test@test.com
   - 電話：0912345678
   - 國家：**點選「台灣」**（不要手動輸入）
   - 行業：**點選任一選項**（不要手動輸入）
   - 訂閱電子報：**打勾**

4. 點擊「取得連結」
5. 複製整個網址

### 3.2 分析網址

網址會像這樣：
```
https://docs.google.com/forms/d/e/XXXXX/viewform?
usp=pp_url&
entry.1234567=測試&
entry.2345678=test@test.com&
entry.3456789=0912345678&
entry.4567890=台灣&
entry.5678901=教育&
entry.6789012=訂閱
```

### 3.3 記錄 entry ID

| 欄位 | entry ID | 如何找 |
|-----|---------|--------|
| 姓名 | entry.??? | 找「=測試」前面的數字 |
| Email | entry.??? | 找「=test@」前面的數字 |
| 電話 | entry.??? | 找「=0912」前面的數字 |
| 國家 | entry.??? | 找「=台灣」前面的數字 |
| 行業 | entry.??? | 找「=教育」前面的數字 |
| 訂閱 | entry.??? | 找「=訂閱」前面的數字 |

---

## 步驟 4：正確設定 script.js

### 4.1 範例（請依您的實際資料修改）

假設您取得的網址是：
```
https://docs.google.com/forms/d/1a2b3c4d5e6f7g8h/viewform?
entry.111111=測試&
entry.222222=test@test.com&
entry.333333=0912345678&
entry.444444=台灣&
entry.555555=教育&
entry.666666=訂閱
```

則設定應該是：
```javascript
const GOOGLE_FORM_CONFIG = {
    enabled: true,
    formId: '1a2b3c4d5e6f7g8h',  // ← 從 /d/ 和 /viewform 之間取得
    fields: {
        fullName: 'entry.111111',
        email: 'entry.222222',
        phone: 'entry.333333',
        country: 'entry.444444',
        industry: 'entry.555555',
        newsletter: 'entry.666666'
    }
};
```

---

## 步驟 5：測試提交

### 5.1 直接測試 Google 表單

先確認 Google 表單本身能正常運作：

1. 開啟您的 Google 表單
2. 點擊「預覽」（眼睛圖示）
3. 手動填寫並提交
4. 查看「回應」標籤
5. **確認資料有進入**

如果手動都沒資料 → Google 表單設定有問題
如果手動有資料 → 是程式設定有問題

### 5.2 測試程式

1. 確認 `enabled: true`
2. 確認 formId 和 entry ID 都正確
3. 重新整理瀏覽器
4. 再次測試提交

---

## 常見錯誤

### ❌ 錯誤 1：Form ID 不對
```javascript
// 錯誤（這是回應連結的 ID）
formId: '1FAIpQLSfgpRp3GyT27oanx3_pLwAlGVgCGdvH-gPnyS_fW-LsueGpFw'

// 正確（從編輯模式網址取得）
formId: '1a2b3c4d5e6f7g8h9i0j'
```

### ❌ 錯誤 2：entry ID 順序錯誤
確保：
- fullName 對應到「姓名」欄位的 entry ID
- email 對應到「電子郵件」欄位的 entry ID
- 依此類推

### ❌ 錯誤 3：國家/行業選項不匹配
確認 `script.js` 中的：
```javascript
const COUNTRY_NAMES = {
    'TW': '台灣',  // ← 必須與 Google 表單選項一致
    ...
};
```

---

## 快速檢查清單

- [ ] Form ID 是從編輯模式網址 `/d/` 後面取得（不是 `/d/e/`）
- [ ] entry ID 是用「取得預填連結」取得
- [ ] 所有欄位都有填寫才取得預填連結
- [ ] enabled 設定為 true
- [ ] 國家和行業選項與表單一致
- [ ] 瀏覽器 Console 沒有錯誤訊息（CORS 警告可忽略）
- [ ] 手動在 Google 表單測試能正常運作

---

## 🆘 如果還是不行

### 提供以下資訊：

1. **瀏覽器 Console 的完整訊息**（截圖）
2. **您的 Google 表單編輯模式網址**（遮蔽敏感部分）
   - 格式：`https://docs.google.com/forms/d/【這段】/edit`
3. **預填連結的網址**（遮蔽敏感部分）
4. **手動測試 Google 表單是否正常**

---

## 💡 最可能的問題

根據經驗，90% 的問題是：

### 問題：Form ID 錯誤
**症狀：** 提交後沒資料
**原因：** 使用了 `/d/e/` 後面的 ID，而不是 `/d/` 後面的 ID
**解決：** 從編輯模式網址重新取得正確的 Form ID

### 檢查方式：
您的 Form ID 長度應該約 30-50 個字元
如果超過 80 個字元，就是錯的！

---

請按照以上步驟檢查，然後告訴我結果！

