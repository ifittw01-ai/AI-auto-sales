# 更新 Google Apps Script 說明

## 📋 功能說明

更新後的 Google Apps Script 會在客戶報名後發送**兩封郵件**：

1. **給推廣人員的通知郵件** - 包含完整客戶資料（原有功能）
2. **給報名客戶的確認郵件** - 感謝信息和社群連結（新功能）✨

---

## 🔧 更新步驟

### 步驟 1：前往 Google Apps Script
1. 開啟瀏覽器，前往：https://script.google.com
2. 登入你的 Google 帳號
3. 找到現有的專案（應該叫做類似 "表單郵件通知" 的名稱）

### 步驟 2：更新代碼
1. 在左側找到 `Code.gs` 檔案
2. **刪除現有的所有代碼**
3. 打開本專案中的 `google-apps-script-updated.js` 檔案
4. **複製全部內容**
5. **貼上到 `Code.gs` 中**

### 步驟 3：確認郵箱對照表
在代碼的第 14-20 行，確認推廣人員郵箱對照表是否正確：

```javascript
const EMAIL_MAPPING = {
    "jordantsai777": "jordantsai777@gmail.com",
    "jordantsai07": "jordantsai07@gmail.com",
    "001": "cchaha888@gmail.com",
    "002": "a0928127137@gmail.com",
    "003": "peter.w2520701@gmail.com"
};
```

**如果需要修改，請同時更新 `script.js` 中的對照表（第 5-14 行）**

### 步驟 4：儲存並部署
1. 點擊上方的 **💾 儲存** 按鈕
2. 點擊 **部署** → **管理部署作業**
3. 點擊現有部署旁的 **✏️ 編輯** 圖示
4. 在 "版本" 下拉選單中選擇 **新版本**
5. 點擊 **部署**
6. 如果需要授權，請點擊 **審查權限** 並授權

### 步驟 5：測試
1. 前往你的網站
2. 填寫並提交表單
3. 檢查以下兩個郵箱：
   - ✅ 推廣人員的郵箱（應收到客戶通知）
   - ✅ 報名客戶的郵箱（應收到確認郵件）

---

## 📧 客戶確認郵件範例

客戶會收到類似以下內容的郵件：

```
主旨：感謝您報名「AI+自媒體創業系統」

王小明，

感謝您對「AI+自媒體創業系統」有興趣！

記得您的時間與地址：北部

歡迎您的到來！

如欲詢問問題，請點選以下連結加入官方社群：
👉 https://line.me/ti/g2/lwbHM8cXtERXRSpCKRNz1q7769jgTxzsKA7iTw?utm_source=invitation&utm_medium=link_copy&utm_campaign=default

我們期待與您在社群中見面，一起探索 AI 創業的無限可能！🚀

---
AI+自媒體創業系統 團隊
```

---

## 🔍 檢查清單

更新完成後，請確認：

- [ ] Google Apps Script 代碼已更新
- [ ] 郵箱對照表正確（`google-apps-script-updated.js` 和 `script.js` 一致）
- [ ] 已部署新版本
- [ ] 已測試表單提交
- [ ] 推廣人員收到通知郵件
- [ ] 報名客戶收到確認郵件

---

## ⚠️ 注意事項

1. **Gmail 發送限制**：
   - 免費 Gmail 帳號：每天最多 100 封郵件
   - Google Workspace 帳號：每天最多 1,500 封郵件
   - 現在每次報名會發送 2 封郵件（給推廣人員 + 給客戶）

2. **垃圾郵件問題**：
   - 提醒客戶檢查垃圾郵件資料夾
   - 建議客戶將發件地址加入通訊錄

3. **郵件內容修改**：
   - 如需修改郵件內容，請編輯 `google-apps-script-updated.js`
   - 客戶確認郵件內容在第 107-125 行
   - 推廣人員通知郵件內容在第 69-94 行

---

## 🆘 疑難排解

### 問題：客戶沒收到確認郵件
**解決方法**：
1. 檢查 Google Apps Script 的執行記錄（執行作業 → 我的執行作業）
2. 查看是否有錯誤訊息
3. 確認客戶填寫的 Email 正確
4. 請客戶檢查垃圾郵件資料夾

### 問題：推廣人員沒收到通知
**解決方法**：
1. 檢查 `EMAIL_MAPPING` 對照表是否正確
2. 確認推廣連結的 `ref` 參數正確
3. 查看 Google Apps Script 執行記錄

### 問題：郵件發送失敗
**解決方法**：
1. 確認 Google 帳號已授權 Gmail 發送權限
2. 檢查是否超過每日發送限制
3. 查看 Google Apps Script 執行記錄中的詳細錯誤訊息

---

## 📞 需要協助？

如果遇到問題，請提供：
1. Google Apps Script 的執行記錄截圖
2. 具體的錯誤訊息
3. 測試時填寫的表單資料

---

更新時間：2025-10-28

