# 🔍 電話號碼問題排查指南

## ✅ 已修復的問題

1. **前端表單字段**：`電話號碼`（已確認正確）
2. **後端接收邏輯**：已更新為同時接受 `電話號碼` 和 `電話`
3. **調試日誌**：已在前端和後端添加完整的數據打印

---

## 🚀 立即執行步驟

### 步驟 1：更新 Google Apps Script

**⚠️ 這是最重要的步驟！**

1. 前往 https://script.google.com
2. 打開你的專案（URL 在 script.js 第 426 行）
3. **完整複製** `google-apps-script-updated.js` 的內容
4. **貼上並覆蓋** Code.gs 中的所有代碼
5. 點擊「儲存」（💾 圖標）
6. 點擊「部署」→「管理部署」
7. 選擇你的現有部署，點擊「✏️ 編輯」
8. 在「版本」下拉選單選擇「新版本」
9. 點擊「部署」

**💡 提示**：如果不選擇「新版本」，修改將不會生效！

---

### 步驟 2：清除網頁緩存

在網頁上按 `Ctrl + Shift + R`（Windows）或 `Cmd + Shift + R`（Mac）強制重新載入

---

### 步驟 3：提交測試表單

1. 打開網頁並點擊「搶先報名」
2. **填寫所有資料，特別是電話號碼**
3. 按 `F12` 打開瀏覽器開發者工具
4. 切換到「Console」（控制台）標籤
5. 提交表單

---

### 步驟 4：查看前端日誌

在 Console 中應該會看到：

```
=== 📋 準備提交的表單資料 ===
  姓名: "張三"
  電子郵件: "test@gmail.com"
  電話號碼: "+886 912345678"   👈 確認這裡有電話號碼
  國家地區: "台灣 Taiwan"
  行業: "自由工作者"
  評估地區: "11/3 星期一 晚上 7:00~9:00..."
  LINE_ID: "mylineid"
  WhatsApp號碼: "+886 912345678"
  推廣代碼: "001"
  ref: "001"
========================
```

**❌ 如果看不到電話號碼**：
- 檢查是否真的填寫了電話號碼欄位
- 檢查瀏覽器是否自動填入了電話號碼（有時會看不到但實際有值）

---

### 步驟 5：查看後端日誌

1. 前往 https://script.google.com
2. 打開你的專案
3. 點擊左側的「執行」圖標（⚡）
4. 查看最新的執行記錄

應該會看到類似：

```
📧 準備發送郵件...
推廣代碼: 001
目標郵箱: xxx@gmail.com
客戶姓名: 張三
客戶郵箱: test@gmail.com
客戶電話: +886 912345678   👈 確認這裡有電話號碼
國家地區: 台灣 Taiwan
行業: 自由工作者
評估地區: 11/3 星期一...
LINE ID: mylineid
WhatsApp: +886 912345678
✅ 已發送郵件給推廣人員: xxx@gmail.com
```

---

## 🐛 常見問題

### Q1: 後端日誌顯示「客戶電話: 」為空

**原因**：Google Apps Script 沒有更新或沒有選擇新版本部署

**解決方法**：
1. 重新執行「步驟 1」，**特別注意第 8 步要選擇「新版本」**
2. 等待 1-2 分鐘讓部署生效
3. 重新測試

### Q2: 前端日誌顯示電話號碼，但後端沒收到

**原因**：字段名稱不匹配

**解決方法**：
確認 `google-apps-script-updated.js` 第 116 行為：
```javascript
const customerPhone = params['電話號碼'] || params['電話'] || '';
```

### Q3: 兩邊都有日誌，但郵件中還是沒有電話號碼

**原因**：郵件模板引用錯誤變數

**解決方法**：
確認郵件模板（第 143 行）是：
```javascript
電話：${customerPhone}
```

---

## 📝 完整檢查清單

- [ ] 已更新 Google Apps Script 代碼
- [ ] 已選擇「新版本」重新部署
- [ ] 已等待 1-2 分鐘讓部署生效
- [ ] 已清除瀏覽器緩存（Ctrl+Shift+R）
- [ ] 已打開開發者工具（F12）查看 Console
- [ ] 已填寫完整表單並提交
- [ ] 前端日誌顯示電話號碼
- [ ] 後端日誌顯示電話號碼
- [ ] 收到的郵件中顯示電話號碼

---

## 📞 緊急聯繫

如果按照以上步驟仍無法解決，請提供：
1. 前端 Console 的完整日誌截圖
2. 後端執行記錄的截圖
3. 收到的郵件截圖

這樣可以快速定位問題！

