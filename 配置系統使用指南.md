# 配置系統使用指南 🔧

## 目錄
1. [簡介](#簡介)
2. [如何進入配置頁面](#如何進入配置頁面)
3. [配置步驟](#配置步驟)
4. [欄位說明](#欄位說明)
5. [測試與驗證](#測試與驗證)
6. [常見問題](#常見問題)

---

## 簡介

配置系統讓您可以透過網頁介面輕鬆設定 Google 表單整合，無需手動修改程式碼。所有設定都會安全地儲存在瀏覽器的本地儲存中。

### 主要功能
- ✅ 視覺化配置介面
- ✅ 即時預覽當前設定
- ✅ 一鍵測試連接
- ✅ 快速恢復預設設定
- ✅ 本地安全儲存

---

## 如何進入配置頁面

有三種方式可以進入配置頁面：

### 方法 1：從主頁進入
1. 打開 `index.html`
2. 滾動到頁面底部
3. 點擊 Footer 中的 **「⚙️ 系統設定」** 連結

### 方法 2：從資料查看頁面進入
1. 打開 `records.html`
2. 點擊右上角的 **「⚙️ 系統設定」** 按鈕

### 方法 3：直接開啟
- 直接在瀏覽器中打開 `setup.html` 檔案

---

## 配置步驟

### 第一步：準備 Google 表單

1. **建立 Google 表單**
   - 前往 [Google Forms](https://forms.google.com/)
   - 建立新表單或選擇現有表單

2. **添加必要欄位**
   - 姓名（簡答）
   - 電子郵件（簡答）
   - 電話（簡答）
   - 國家/地區（下拉式選單或簡答）
   - 行業（下拉式選單）
   - 訂閱電子報（核取方塊）

### 第二步：取得預填連結

1. 在 Google 表單右上角點擊 **「⋮」** (更多選項)
2. 選擇 **「取得預填連結」**
3. 為每個欄位填入範例值：
   ```
   姓名: 測試姓名
   電子郵件: test@example.com
   電話: +886912345678
   國家/地區: 台灣
   行業: 其他
   訂閱電子報: ☑️
   ```
4. 點擊 **「取得連結」**
5. 複製產生的網址

### 第三步：提取配置資訊

從複製的網址中提取資訊：

**範例網址：**
```
https://docs.google.com/forms/d/e/1FAIpQLSfgpRp3GyT27oanx3_pLwAlGVgCGdvH-gPnyS_fW-LsueGpFw/viewform?usp=pp_url&entry.1124417422=測試姓名&entry.1571446378=test@example.com&entry.51167075=+886912345678&entry.251150813=台灣&entry.828038711=其他&entry.1980319875=是
```

**提取內容：**

1. **Form ID**（在 `/d/e/` 和 `/viewform` 之間）
   ```
   1FAIpQLSfgpRp3GyT27oanx3_pLwAlGVgCGdvH-gPnyS_fW-LsueGpFw
   ```

2. **各欄位的 Entry ID**（`entry.` 開頭的數字）
   ```
   姓名: entry.1124417422
   電子郵件: entry.1571446378
   電話: entry.51167075
   國家/地區: entry.251150813
   行業: entry.828038711
   訂閱電子報: entry.1980319875
   ```

### 第四步：填寫配置表單

1. 打開配置頁面 (`setup.html`)
2. 確認 **「啟用 Google 表單整合」** 開關已開啟
3. 在各欄位輸入提取的資訊：
   - **Google 表單 ID**: 貼上 Form ID
   - **姓名欄位 Entry ID**: 貼上對應的 entry ID
   - **Email 欄位 Entry ID**: 貼上對應的 entry ID
   - **電話欄位 Entry ID**: 貼上對應的 entry ID
   - **國家欄位 Entry ID**: 貼上對應的 entry ID
   - **行業欄位 Entry ID**: 貼上對應的 entry ID
   - **訂閱欄位 Entry ID**: 貼上對應的 entry ID

4. 點擊 **「🧪 測試連接」** 驗證設定
5. 確認無誤後，點擊 **「💾 儲存設定」**

---

## 欄位說明

### Google 表單 ID
- **格式**: 長字串，通常以 `1FAIpQL` 開頭
- **範例**: `1FAIpQLSfgpRp3GyT27oanx3_pLwAlGVgCGdvH-gPnyS_fW-LsueGpFw`
- **位置**: 預填連結中 `/d/e/` 和 `/viewform` 之間

### Entry ID
- **格式**: `entry.` 後接數字
- **範例**: `entry.1124417422`
- **說明**: 每個表單欄位都有唯一的 Entry ID
- **注意**: 如果更改表單欄位，Entry ID 可能會改變

### 啟用/停用開關
- **開啟**: 資料將提交到 Google 表單（同時也會儲存到本地作為備份）
- **關閉**: 資料僅儲存在瀏覽器本地，不提交到 Google 表單

---

## 測試與驗證

### 測試連接功能

1. 填寫完所有欄位後，點擊 **「🧪 測試連接」**
2. 系統會自動提交測試資料到您的表單
3. 前往您的 Google 表單查看回應
4. 確認測試資料是否正確出現在表單回應中

### 測試資料範例
```
姓名: 測試姓名 Test Name
電子郵件: test@example.com
電話: +886912345678
國家/地區: 台灣
行業: 其他
訂閱電子報: 是
```

### 完整測試流程

1. **在配置頁面測試**
   - 使用「測試連接」功能
   - 檢查 Google 表單是否收到資料

2. **在主頁面測試**
   - 返回 `index.html`
   - 點擊任一 CTA 按鈕
   - 填寫測試資料並提交
   - 確認提交成功訊息
   - 檢查 Google 表單回應

3. **檢查本地備份**
   - 前往 `records.html`
   - 確認資料已儲存
   - 測試匯出 Excel 功能

---

## 常見問題

### Q1: 儲存設定後，主頁還是使用舊設定？
**A**: 請重新整理主頁（按 F5 或 Ctrl+R），新設定會自動載入。

### Q2: 測試連接失敗怎麼辦？
**A**: 
- 檢查 Form ID 是否正確
- 確認所有 Entry ID 都以 `entry.` 開頭
- 確認 Google 表單沒有被刪除或停用
- 嘗試在無痕視窗中測試

### Q3: 如何確認設定是否生效？
**A**: 
1. 查看配置頁面的「當前設定」區塊
2. 在主頁提交測試資料
3. 檢查 Google 表單回應

### Q4: 可以在不同電腦上使用不同設定嗎？
**A**: 可以。設定儲存在瀏覽器的 localStorage 中，每個設備/瀏覽器的設定是獨立的。

### Q5: 如何備份我的設定？
**A**: 
1. 在配置頁面複製「當前設定」區塊的內容
2. 儲存到文字檔案中
3. 需要時可以手動複製回配置表單

### Q6: 如何恢復預設設定？
**A**: 點擊配置頁面的 **「🔄 恢復預設」** 按鈕。

### Q7: 設定會過期嗎？
**A**: 不會。設定會永久儲存在瀏覽器中，除非：
- 手動清除瀏覽器資料
- 使用「恢復預設」功能
- 重新儲存新設定

### Q8: 多人使用時如何設定？
**A**: 
- 如果多人共用同一台電腦/瀏覽器：設定會共用
- 如果每人使用自己的電腦：每人需要各自設定

### Q9: Entry ID 會改變嗎？
**A**: 以下情況可能導致 Entry ID 改變：
- 刪除並重新建立表單欄位
- 複製表單
- 更改欄位類型

建議：重要變更後重新取得預填連結並更新設定。

### Q10: 可以連接多個不同的表單嗎？
**A**: 目前系統僅支援一個表單。如需連接不同表單，需要：
- 在配置頁面切換設定
- 或使用不同的瀏覽器/設備

---

## 進階使用

### 在不同環境使用不同設定

**開發環境**:
- 使用測試用的 Google 表單
- 在 Chrome 正常模式下設定

**正式環境**:
- 使用正式的 Google 表單
- 在其他瀏覽器或無痕模式下設定

### 快速切換設定

1. 在配置頁面記錄不同的設定
2. 需要切換時，複製對應的設定
3. 貼上並儲存即可

---

## 技術支援

### 需要協助？

1. **查看文件**
   - [Google表單整合指南.md](Google表單整合指南.md)
   - [測試並上線指南.md](測試並上線指南.md)
   - [問題排查指南.md](問題排查指南.md)

2. **檢查設定**
   - 在配置頁面查看「當前設定」
   - 使用瀏覽器開發者工具（F12）查看 Console 訊息

3. **聯繫支援**
   - Email: [email protected]

---

## 總結

配置系統讓 Google 表單整合變得簡單快速：

✅ **無需修改程式碼** - 透過網頁界面完成所有設定  
✅ **即時生效** - 儲存後立即可用  
✅ **安全可靠** - 本地儲存，隨時可修改  
✅ **易於測試** - 內建測試功能  
✅ **彈性切換** - 可隨時更新或恢復預設  

開始使用前，建議先用測試表單練習設定流程，確認熟悉後再設定正式表單。

---

**最後更新**: 2025-10-08  
**版本**: 1.0

